<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- وسم المعاينة (Thumbnail) - يظهر عند إرسال الرابط -->
    <title>الكرة في الأغواط | Kooora Laghouat</title>
    <meta name="description" content="البث المباشر لمباريات فرق ولاية الأغواط في مختلف الدوريات - نتائج حية لحظة بلحظة.">
    
    <meta property="og:type" content="website">
    <meta property="og:title" content="الكرة في الأغواط - Kooora Laghouat">
    <meta property="og:description" content="تغطية حصرية لنتائج مباريات أندية ولاية الأغواط.">
    <meta property="og:image" content="https://l.top4top.io/p_36387ks911.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&family=JetBrains+Mono:wght@700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #f8fafc; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .bg-watermark { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 85%; opacity: 0.03; pointer-events: none; z-index: -1; }
        
        /* إطار البطولة الاحترافي العريض */
        .league-banner {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            border: 2px solid #34d399;
            box-shadow: 0 10px 20px -5px rgba(16, 185, 129, 0.3);
            width: fit-content;
        }

        /* السلايدر المتحرك من اليسار إلى اليمين */
        @keyframes marquee { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
        .news-ticker { display: inline-block; white-space: nowrap; animation: marquee 20s linear infinite; }
        
        /* نبض المباشر */
        .live-pulse { width: 8px; height: 8px; background: #ef4444; border-radius: 50%; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); } 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); } }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <img src="https://l.top4top.io/p_36387ks911.jpg" class="bg-watermark">
    <div id="root"></div>

    <script type="text/babel">
        // إعدادات Firebase
        const firebaseConfig = {
          apiKey: "AIzaSyAXLSZ5OqPEOnP0DUx3w75fU2xxiVkrWcE",
          authDomain: "koooralaghouat.firebaseapp.com",
          projectId: "koooralaghouat",
          storageBucket: "koooralaghouat.firebasestorage.app",
          messagingSenderId: "84750708348",
          appId: "1:84750708348:web:179ec7acf8fc2f357e23f9"
        };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const { useState, useEffect, Fragment } = React;

        // الترتيب المطلوب للبطولات
        const LEAGUE_ORDER = [
            "قسم ما بين الرابطات",
            "الجهوي الأول (فوج أ)",
            "الجهوي الأول (فوج ب)",
            "الجهوي الثاني (فوج ج)",
            "بطولات الولائي"
        ];

        const isMatchLive = (match) => {
            const liveStatuses = ['الشوط الأول', 'الشوط الثاني', 'نهاية الشوط الأول', 'استراحة'];
            return match.isRunning || liveStatuses.includes(match.status);
        };

        const MatchCard = ({ match }) => {
            const [timer, setTimer] = useState("00:00");
            const live = isMatchLive(match);

            useEffect(() => {
                let interval;
                const updateTimer = () => {
                    let totalSeconds = (match.time || 0) * 60;
                    if (match.isRunning && match.lastStartTime) {
                        totalSeconds += Math.floor((Date.now() - match.lastStartTime) / 1000);
                    }
                    const mins = Math.floor(totalSeconds / 60).toString().padStart(2, '0');
                    const secs = (totalSeconds % 60).toString().padStart(2, '0');
                    setTimer(`${mins}:${secs}`);
                };
                updateTimer();
                if (match.isRunning) interval = setInterval(updateTimer, 1000);
                return () => clearInterval(interval);
            }, [match.isRunning, match.time, match.lastStartTime]);

            return (
                <div className="bg-white/95 backdrop-blur-sm mb-6 rounded-[28px] shadow-sm border border-slate-200 overflow-hidden transition-all duration-500 hover:shadow-xl">
                    {/* السلايدر المتحرك (أحداث اللقاء) */}
                    {match.events && (
                        <div className="bg-emerald-600 text-white h-7 flex items-center relative overflow-hidden">
                            <div className="absolute left-0 bg-emerald-900 px-3 h-full flex items-center z-10 font-black text-[9px] italic shadow-xl">عاجل</div>
                            <div className="news-ticker pl-12">
                                <span className="text-[10px] font-bold mx-10">{match.events}</span>
                                <span className="text-[10px] font-bold mx-10 opacity-30">•</span>
                                <span className="text-[10px] font-bold mx-10">{match.events}</span>
                            </div>
                        </div>
                    )}

                    <div className="p-5">
                        {/* معلومات الجولة والحالة */}
                        <div className="flex justify-between items-center mb-6 border-b border-slate-50 pb-3">
                            <div className="flex items-center gap-2">
                                {live && match.status !== 'استراحة' && match.status !== 'نهاية المباراة' && <div className="live-pulse"></div>}
                                <span className={`text-[10px] font-black uppercase tracking-tighter ${live ? 'text-red-500' : 'text-slate-400'}`}>
                                    {match.status}
                                </span>
                            </div>
                            <div className="flex items-center gap-2">
                                <span className="bg-emerald-50 text-emerald-600 px-2 py-0.5 rounded-lg text-[9px] font-black border border-emerald-100 italic">الجولة {match.round}</span>
                                <span className="text-[10px] font-bold text-slate-400">{match.matchDate}</span>
                            </div>
                        </div>

                        {/* الفرق والنتيجة */}
                        <div className="flex items-center justify-between gap-2">
                            {/* المستضيف */}
                            <div className="flex flex-col items-center w-[32%] gap-3 text-center">
                                <div className="w-16 h-16 bg-slate-50 rounded-3xl p-2 flex items-center justify-center border border-slate-100 shadow-inner">
                                    <img src={match.homeLogo} className="max-w-full max-h-full object-contain" onError={(e)=>e.target.src='https://cdn-icons-png.flaticon.com/512/53/53283.png'} />
                                </div>
                                <h4 className="text-[12px] font-black text-slate-800 leading-tight min-h-[30px] flex items-center justify-center">{match.home}</h4>
                            </div>

                            {/* النتيجة المركزية */}
                            <div className="flex flex-col items-center flex-1">
                                {match.status === 'لم تبدأ' && (
                                    <span className="text-[11px] font-black text-emerald-600 mb-2 mono tracking-tighter bg-emerald-50 px-3 py-0.5 rounded-full border border-emerald-100">{match.matchTime}</span>
                                )}
                                
                                <div className="bg-[#0f172a] text-white flex items-center justify-center gap-4 px-6 py-2.5 rounded-[20px] shadow-2xl w-full max-w-[150px]">
                                    {match.status !== 'لم تبدأ' ? (
                                        <Fragment>
                                            <span className="text-2xl font-black mono tracking-tighter">{match.scoreH}</span>
                                            <span className="text-emerald-500 opacity-40 font-light">:</span>
                                            <span className="text-2xl font-black mono tracking-tighter">{match.scoreA}</span>
                                        </Fragment>
                                    ) : <span className="text-xs font-black tracking-widest text-emerald-400 italic">VS</span>}
                                </div>

                                {live && (
                                    <span className="mt-2 text-[14px] font-mono font-black text-red-600 tracking-tighter italic">
                                        {match.status === 'استراحة' ? "45:00" : timer}
                                    </span>
                                )}
                            </div>

                            {/* الضيف */}
                            <div className="flex flex-col items-center w-[32%] gap-3 text-center">
                                <div className="w-16 h-16 bg-slate-50 rounded-3xl p-2 flex items-center justify-center border border-slate-100 shadow-inner">
                                    <img src={match.awayLogo} className="max-w-full max-h-full object-contain" onError={(e)=>e.target.src='https://cdn-icons-png.flaticon.com/512/53/53283.png'} />
                                </div>
                                <h4 className="text-[12px] font-black text-slate-800 leading-tight min-h-[30px] flex items-center justify-center">{match.away}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [matches, setMatches] = useState([]);
            const [tab, setTab] = useState('all');

            useEffect(() => {
                return db.collection("matches").onSnapshot(s => setMatches(s.docs.map(d => ({id:d.id, ...d.data()}))));
            }, []);

            const filtered = matches.filter(m => {
                if (tab === 'live') return isMatchLive(m);
                if (tab === 'done') return m.status === 'نهاية المباراة';
                return true;
            });

            const grouped = filtered.reduce((acc, m) => { (acc[m.league] = acc[m.league] || []).push(m); return acc; }, {});
            const sortedLeagues = Object.keys(grouped).sort((a, b) => (LEAGUE_ORDER.indexOf(a) === -1 ? 99 : LEAGUE_ORDER.indexOf(a)) - (LEAGUE_ORDER.indexOf(b) === -1 ? 99 : LEAGUE_ORDER.indexOf(b)));
            
            const liveCount = matches.filter(m => isMatchLive(m)).length;

            return (
                <div className="max-w-xl mx-auto min-h-screen pb-20">
                    {/* Header المطور بالشعار والوصف الكامل */}
                    <header className="sticky top-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-200 px-6 h-24 flex items-center justify-between shadow-sm">
                        <div className="flex items-center gap-4">
                            <img src="https://l.top4top.io/p_36387ks911.jpg" className="w-14 h-14 rounded-full border-2 border-white shadow-lg object-cover" />
                            <div className="flex flex-col">
                                <h1 className="text-2xl font-[900] text-slate-900 tracking-tighter italic uppercase">الكرة في <span className="text-emerald-600 font-[900]">الأغواط</span></h1>
                                <span className="text-[10px] font-bold text-slate-500 mt-1 leading-tight">البث المباشر لمباريات فرق ولاية الأغواط في الدوريات</span>
                            </div>
                        </div>
                        <a href="https://www.facebook.com/kooralghouat" target="_blank" className="bg-blue-600 text-white p-2.5 rounded-full shadow-lg active:scale-90 transition-transform">
                            <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
                        </a>
                    </header>

                    <div className="px-5 pt-8 text-right">
                        {/* نظام التبويبات المطور */}
                        <div className="flex bg-slate-200/50 p-1 rounded-[22px] mb-12 border border-white/50 shadow-inner">
                            <button onClick={()=>setTab('all')} className={`flex-1 py-3.5 rounded-[18px] text-[11px] font-[900] transition-all duration-300 ${tab==='all' ? 'bg-white shadow-xl text-slate-900' : 'text-slate-500'}`}>الرئيسية</button>
                            <button onClick={()=>setTab('live')} className={`flex-1 py-3.5 rounded-[18px] text-[11px] font-[900] transition-all duration-300 flex items-center justify-center gap-2 ${tab==='live' ? 'bg-red-500 text-white shadow-lg' : 'text-slate-500'}`}>
                                مباشر الآن 
                                {liveCount > 0 && <span className="bg-white text-red-600 w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-black shadow-sm animate-bounce">{liveCount}</span>}
                            </button>
                            <button onClick={()=>setTab('done')} className={`flex-1 py-3.5 rounded-[18px] text-[11px] font-[900] transition-all duration-300 ${tab==='done' ? 'bg-slate-800 text-white shadow-xl' : 'text-slate-500'}`}>النتائج</button>
                        </div>

                        {/* قائمة المباريات المنظمة بالبطولات */}
                        {sortedLeagues.map(league => (
                            <div key={league} className="mb-14">
                                {/* إطار البطولة الأخضر البارز */}
                                <div className="flex items-center mb-6 px-1">
                                    <div className="league-banner text-white px-5 py-2.5 rounded-2xl flex items-center gap-3">
                                        <span className="w-2 h-2 bg-white rounded-full animate-pulse shadow-[0_0_8px_white]"></span>
                                        <h3 className="font-[900] text-[13px] uppercase tracking-tighter italic">{league}</h3>
                                    </div>
                                    <div className="h-[2px] flex-1 bg-emerald-100 mr-3 rounded-full opacity-50"></div>
                                </div>
                                {grouped[league].map(m => <MatchCard key={m.id} match={m} />)}
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>